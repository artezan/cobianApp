(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{AWkY:function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),u=t("d2aY"),i=t("OpV+"),r=t("67Y/"),o=t("q3Kh"),a=t("1jtX"),c=t("t/Na"),s=function(){function n(n){this.http=n}return n.prototype.getAll=function(){return this.http.get(a.a.CHAT).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.getByProp=function(n){return this.http.get(a.a.CHAT_PROP_ID+n).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.getByChatId=function(n){return this.http.get(a.a.CHAT_ID+n).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.getByCity=function(n){return this.http.get(a.a.CHAT_CITY_ID+n).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.addMsg=function(n,l){return this.http.post(a.a.CHAT_ADD_MSG,{_id:n,newMessages:l}).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.addRead=function(n,l,t){return this.http.post(a.a.CHAT_ADD_READ,{_id:n,messagesId:l,uid:t}).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.newChat=function(n,l,t){return void 0===t&&(t="Puebla"),this.http.post(a.a.CHAT,{buyer:n,property:l,city:t,messages:[]}).pipe(Object(o.map)(function(n){return n.data}))},n.prototype.deletedById=function(n){return this.http.delete(a.a.CHAT+n).pipe(Object(o.map)(function(n){return n.data}))},n.ngInjectableDef=e.T({factory:function(){return new n(e.X(c.c))},token:n,providedIn:"root"}),n}(),p=t("zj32"),h=t("Pffd"),f=t("bpWO"),d=t("9jYU"),g=function(n,l,t,e){return new(t||(t=Promise))(function(u,i){function r(n){try{a(e.next(n))}catch(n){i(n)}}function o(n){try{a(e.throw(n))}catch(n){i(n)}}function a(n){n.done?u(n.value):new t(function(l){l(n.value)}).then(r,o)}a((e=e.apply(n,l||[])).next())})},m=function(n,l){var t,e,u,i,r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,e&&(u=2&i[0]?e.return:i[0]?e.throw||((u=e.return)&&u.call(e),0):e.next)&&!(u=u.call(e,i[1])).done)return u;switch(e=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,e=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(u=(u=r.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){r.label=i[1];break}if(6===i[0]&&r.label<u[1]){r.label=u[1],u=i;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(i);break}u[2]&&r.ops.pop(),r.trys.pop();continue}i=l.call(n,r)}catch(n){i=[6,n],e=0}finally{t=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},b=function(){function n(n,l,t,e,u,i,r,o){this.userSessionService=n,this.statusBPService=l,this.chatService=t,this.router=e,this.sellerService=u,this.propertyService=i,this.preBuyerService=r,this.preBuildService=o,this.propertiesBuyer=[],this.chats=[],this.user=n.userSession.value}return n.prototype.ngOnInit=function(){"buyer"===this.user.type?this.getStatus():"preBuyer"===this.user.type?this.getPrebuyer():this.getRoomChatsByUser()},n.prototype.getPrebuyer=function(){var n=this;this.preBuyerService.getBuyerById(this.user.id).subscribe(function(l){var t=l.preBuild.filter(function(n){return!n.timeLine.some(function(n){return!n.isComplete})});console.log(t),t.length>0&&(t.forEach(function(l){return g(n,void 0,void 0,function(){var n,t,e;return m(this,function(u){switch(u.label){case 0:return t=(n=this.propertiesBuyer).push,e={status:"azul",property:{_id:l._id,name:l.name}},[4,this.getMsgNotReadByProp(l._id)];case 1:return t.apply(n,[(e.noRead=u.sent(),e)]),[2]}})})}),console.log(n.propertiesBuyer))})},n.prototype.getStatus=function(){var n=this;this.isLoad=!1,this.statusBPService.findByBuyer(this.user.id).pipe(Object(r.a)(function(n){return n.filter(function(n){return"azul"===n.status})})).subscribe(function(l){n.propertiesBuyer=l,n.propertiesBuyer.map(function(l){return g(n,void 0,void 0,function(){var n,t;return m(this,function(e){switch(e.label){case 0:return n=l,t="noRead",[4,this.getMsgNotReadByProp(l.property._id)];case 1:return n[t]=e.sent(),[2]}})})}),n.isLoad=!0})},n.prototype.getRoomChatsByUser=function(){var n=this;this.isLoad=!1,this.chatService.getAll().subscribe(function(l){return g(n,void 0,void 0,function(){var n,t=this;return m(this,function(e){switch(e.label){case 0:return l.forEach(function(n){t.checkIsLive(n.property,n._id)}),"seller"!==this.user.type?[3,2]:[4,this.getSeller()];case 1:return n=e.sent(),this.chats=l.filter(function(l){return n.property.some(function(n){return n._id===l.property})}),[3,3];case 2:this.chats="management"===this.user.type?l.filter(function(n){return"Puebla"===n.city}):l,e.label=3;case 3:return this.chats.map(function(n){return g(t,void 0,void 0,function(){var l,t,e,u;return m(this,function(i){switch(i.label){case 0:return l=n,t="noRead",[4,this.getMsgNotReadByProp(n.property)];case 1:return l[t]=i.sent(),e=n,u="prop",[4,this.getProperty(n.property)];case 2:return e[u]=i.sent(),[2]}})})}),this.isLoad=!0,[2]}})})})},n.prototype.getMsgNotReadByProp=function(n){return g(this,void 0,void 0,function(){var l,t=this;return m(this,function(e){switch(e.label){case 0:return[4,this.chatService.getByProp(n).toPromise()];case 1:return null!==(l=e.sent())?[2,l.messages.filter(function(n){return!n.readBy.some(function(n){return n===t.user.id})}).length]:[2,0]}})})},n.prototype.goToRoom=function(n){this.router.navigate(["chat/room"],{queryParams:{id:n}})},n.prototype.getSeller=function(){return g(this,void 0,void 0,function(){return m(this,function(n){switch(n.label){case 0:return[4,this.sellerService.getSellerById(this.user.id).toPromise()];case 1:return[2,n.sent()]}})})},n.prototype.getProperty=function(n){return g(this,void 0,void 0,function(){var l;return m(this,function(t){switch(t.label){case 0:return[4,this.propertyService.getPropertyById(n).toPromise()];case 1:return null===(l=t.sent())?[3,2]:[2,l];case 2:return[4,this.preBuildService.getBuildById(n).toPromise()];case 3:return[2,l=t.sent()]}})})},n.prototype.checkIsLive=function(n,l){return g(this,void 0,void 0,function(){return m(this,function(t){switch(t.label){case 0:return[4,this.propertyService.getPropertyById(n).toPromise()];case 1:return null!==t.sent()?[3,3]:[4,this.preBuildService.getBuildById(n).toPromise()];case 2:null===t.sent()&&this.chatService.deletedById(l).subscribe(),t.label=3;case 3:return[2]}})})},n}(),y=(t("OO+k"),t("XRfs")),P=t("Sf7E"),v=t("vsjn"),k=function(n,l,t,e){return new(t||(t=Promise))(function(u,i){function r(n){try{a(e.next(n))}catch(n){i(n)}}function o(n){try{a(e.throw(n))}catch(n){i(n)}}function a(n){n.done?u(n.value):new t(function(l){l(n.value)}).then(r,o)}a((e=e.apply(n,l||[])).next())})},x=function(n,l){var t,e,u,i,r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,e&&(u=2&i[0]?e.return:i[0]?e.throw||((u=e.return)&&u.call(e),0):e.next)&&!(u=u.call(e,i[1])).done)return u;switch(e=0,u&&(i=[2&i[0],u.value]),i[0]){case 0:case 1:u=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,e=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(u=(u=r.trys).length>0&&u[u.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!u||i[1]>u[0]&&i[1]<u[3])){r.label=i[1];break}if(6===i[0]&&r.label<u[1]){r.label=u[1],u=i;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(i);break}u[2]&&r.ops.pop(),r.trys.pop();continue}i=l.call(n,r)}catch(n){i=[6,n],e=0}finally{t=u=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}},I=function(){function n(n,l,t,e,u,i,r,o,a,c){var s=this;this.route=n,this.chatService=l,this.userService=t,this.propertyService=e,this.preBuildService=u,this.socketService=i,this.oneSignalService=r,this.sellerService=o,this.router=a,this.buyerService=c,this.istoLast=!1,this.stringHeigh=[],this.isFirstEnter=!1,this.user=t.userSession.value,this.route.queryParams.subscribe(function(n){return k(s,void 0,void 0,function(){var l,t;return x(this,function(e){switch(e.label){case 0:return n.id?"preBuyer"!==this.user.type?[3,2]:(this.getRoomById(n.id),[4,this.getprePropertyById(n.id)]):[3,5];case 1:return l=e.sent(),this.property=l,this.title=l.name,[3,5];case 2:return this.getRoomById(n.id),[4,this.getPropertyById(n.id)];case 3:return l=e.sent(),t=this,[4,this.getSellerOfProperty(n.id)];case 4:t.seller=e.sent(),this.property=l,this.title=l.name?l.name:"",e.label=5;case 5:return[2]}})})}),this.socketService.onNewMsg().subscribe(function(n){n===s.chat._id&&s.getRoomByChatId(s.chat._id)})}return n.prototype.ngOnInit=function(){},n.prototype.textAreaKeyup=function(){var n=this;this.isFirstEnter||(this.oldHeigh=this.myInput.nativeElement.scrollHeight,this.isFirstEnter=!0),this.myInput.nativeElement.scrollHeight>this.oldHeigh&&(this.stringHeigh.push({heigh:this.oldHeigh,numOfstring:this.contentText.length-1}),this.oldHeigh=this.myInput.nativeElement.scrollHeight);var l=this.stringHeigh.findIndex(function(l){return l.numOfstring===n.contentText.length});-1!==l?(this.myInput.nativeElement.style.height=this.stringHeigh[l].heigh+"px",this.stringHeigh.splice(l,1),this.oldHeigh=this.myInput.nativeElement.scrollHeight):this.myInput.nativeElement.style.height=this.myInput.nativeElement.scrollHeight+"px"},n.prototype.getRoomById=function(n){var l=this;this.isLoad=!1,this.chatService.getByProp(n).subscribe(function(t){return k(l,void 0,void 0,function(){var l;return x(this,function(e){switch(e.label){case 0:return null!==t?[3,1]:(this.newChat(n),[3,3]);case 1:return this.chat=t,l=this,[4,this.getBuyerOfId(t.buyer)];case 2:l.buyer=e.sent(),this.scrollBottom(),this.isLoad=!0,e.label=3;case 3:return[2]}})})})},n.prototype.getRoomByChatId=function(n){var l=this;this.chatService.getByChatId(n).subscribe(function(n){l.chat=n,l.scrollBottom(),l.isLoad=!0,l.isSending=!0,console.log(n)})},n.prototype.getPropertyById=function(n){return k(this,void 0,void 0,function(){var l;return x(this,function(t){switch(t.label){case 0:return[4,this.propertyService.getPropertyById(n).toPromise()];case 1:return null===(l=t.sent())?[3,2]:[2,l];case 2:return[4,this.preBuildService.getBuildById(n).toPromise()];case 3:return[2,l=t.sent()]}})})},n.prototype.getprePropertyById=function(n){return k(this,void 0,void 0,function(){return x(this,function(l){switch(l.label){case 0:return[4,this.preBuildService.getBuildById(n).toPromise()];case 1:return[2,l.sent()]}})})},n.prototype.submit=function(){return k(this,void 0,void 0,function(){var n,l,t,e,u=this;return x(this,function(i){switch(i.label){case 0:return this.isSending=!1,n={content:this.contentText,createAt:new Date,readBy:[this.user.id],uid:this.user.id,typeOfUser:this.user.type},[4,this.chatService.addMsg(this.chat._id,n).toPromise()];case 1:return i.sent()?[4,this.getSellerOfProperty(this.property._id)]:[3,3];case 2:l=i.sent(),t=[],-1!==(e=(t=void 0===l?[this.chat.buyer]:[l._id,this.chat.buyer]).findIndex(function(n){return n===u.user.id}))&&t.splice(e,0),this.notification("Nuevo Mensaje",this.user.name+": "+this.contentText,"verde","msg",["office","management"],t),i.label=3;case 3:return this.stringHeigh.length>0&&(this.myInput.nativeElement.style.height=this.stringHeigh[0].heigh+"px",this.stringHeigh.length=0),this.contentText="".trim(),this.scrollBottom(),[2]}})})},n.prototype.newChat=function(n){var l=this;this.chatService.newChat(this.user.id,n).subscribe(function(n){l.chat=n,l.isLoad=!0})},n.prototype.trackByCreated=function(n){return n.createAt},n.prototype.scrollBottom=function(){var n=this;setTimeout(function(){n.content.scrollToBottom()},10)},n.prototype.lastScroll=function(n){var l=this;this.istoLast||n!==this.chat.messages.length-1||(setTimeout(function(){l.content.scrollToBottom()},10),this.istoLast=!0)},n.prototype.notification=function(n,l,t,e,u,i){var r=this,o={title:n,message:l,tags:u,receiversId:i,senderId:this.userService.userSession.value.id,status:t,type:e};this.oneSignalService.postOneSignalByTag(o.title,l,u,i).subscribe(function(){r.oneSignalService.newNotification(o).subscribe()})},n.prototype.getSellerOfProperty=function(n){return k(this,void 0,void 0,function(){return x(this,function(l){switch(l.label){case 0:return[4,this.sellerService.getSellerAll().pipe(Object(o.map)(function(l){return l.find(function(l){return!!l.property.find(function(l){return l._id===n})})})).toPromise()];case 1:return[2,l.sent()]}})})},n.prototype.getBuyerOfId=function(n){return k(this,void 0,void 0,function(){return x(this,function(l){switch(l.label){case 0:return[4,this.buyerService.getBuyerById(n).toPromise()];case 1:return[2,l.sent()]}})})},n.prototype.readMsg=function(){var n=this,l=this.chat.messages.filter(function(l){return!l.readBy.some(function(l){return l===n.user.id})}).map(function(n){return n._id});this.chatService.addRead(this.chat._id,l,this.user.id).subscribe()},n.prototype.ngOnDestroy=function(){this.readMsg()},n.prototype.backOne=function(){var n=this;this.router.navigateByUrl("/RefrshComponent",{skipLocationChange:!0}).then(function(){return n.router.navigate(["chat"])})},n}(),B=function(){},w=t("pMnS"),S=t("ra/t"),C=t("ntG5"),Q=t("Ip0R"),j=t("M9A9"),M=t("ZYCi"),O=e.Oa({encapsulation:0,styles:[[".content-card-chat[_ngcontent-%COMP%]{padding:0 20px 10px!important}#badge[_ngcontent-%COMP%]{position:absolute;top:1px;right:2px;font-size:x-small}"]],data:{}});function H(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,0,null,null,null,null,null,null,null))],null,null)}function _(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"ion-icon",[["name","mail"],["slot","end"]],null,null,null,S.Pa,S.u)),e.Pa(1,49152,null,0,C.A,[e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"mail")},null)}function T(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,2,"ion-badge",[["color","danger"],["id","badge"]],null,null,null,S.X,S.c)),e.Pa(1,49152,null,0,C.e,[e.k],{color:[0,"color"]},null),(n()(),e.hb(2,0,["",""]))],function(n,l){n(l,1,0,"danger")},function(n,l){n(l,2,0,l.parent.context.$implicit.noRead)})}function E(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,25,"ion-card",[],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.goToRoom(n.context.$implicit.property._id)&&e),e},S.Ea,S.f)),e.Pa(1,278528,null,0,Q.i,[e.s,e.t,e.k,e.E],{ngClass:[0,"ngClass"]},null),e.db(2,{"state-verde":0,"state-amarillo":1,"state-rojo":2,"state-azul":3}),e.Pa(3,49152,null,0,C.h,[e.k],null,null),(n()(),e.Qa(4,0,null,0,11,"ion-card-header",[],null,null,null,S.Ba,S.h)),e.Pa(5,49152,null,0,C.j,[e.k],null,null),(n()(),e.Qa(6,0,null,0,9,"ion-item",[["lines","none"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==e.ab(n,8).onClick(t)&&u),u},S.Sa,S.x)),e.Pa(7,49152,null,0,C.F,[e.k],{lines:[0,"lines"]},null),e.Pa(8,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(9,0,null,0,2,"ion-card-title",[["text-wrap",""]],null,null,null,S.Da,S.j)),e.Pa(10,49152,null,0,C.l,[e.k],null,null),(n()(),e.hb(11,0,["",""])),(n()(),e.Ha(16777216,null,0,1,null,_)),e.Pa(13,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,0,1,null,T)),e.Pa(15,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Qa(16,0,null,0,9,"ion-card-content",[["class","content-card-chat"]],null,null,null,S.Aa,S.g)),e.Pa(17,49152,null,0,C.i,[e.k],null,null),(n()(),e.Qa(18,0,null,0,7,"ion-item",[["lines","none"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==e.ab(n,20).onClick(t)&&u),u},S.Sa,S.x)),e.Pa(19,49152,null,0,C.F,[e.k],{lines:[0,"lines"]},null),e.Pa(20,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(21,0,null,0,1,"ion-icon",[["name","arrow-forward"],["slot","end"],["style","color:  #F5811E"]],null,null,null,S.Pa,S.u)),e.Pa(22,49152,null,0,C.A,[e.k],{name:[0,"name"]},null),(n()(),e.Qa(23,0,null,0,2,"ion-label",[["text-wrap",""]],null,null,null,S.Ta,S.y)),e.Pa(24,49152,null,0,C.L,[e.k],null,null),(n()(),e.hb(-1,0,["Chat de la propiedad"]))],function(n,l){n(l,1,0,n(l,2,0,"verde"===l.context.$implicit.status,"amarillo"===l.context.$implicit.status,"rojo"===l.context.$implicit.status,"azul"===l.context.$implicit.status)),n(l,7,0,"none"),n(l,13,0,l.context.$implicit.noRead>0),n(l,15,0,l.context.$implicit.noRead>0),n(l,19,0,"none"),n(l,22,0,"arrow-forward")},function(n,l){n(l,11,0,l.context.$implicit.property.name)})}function R(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,2,null,null,null,null,null,null,null)),(n()(),e.Ha(16777216,null,null,1,null,E)),e.Pa(2,278528,null,0,Q.j,[e.P,e.M,e.s],{ngForOf:[0,"ngForOf"]},null),(n()(),e.Ha(0,null,null,0))],function(n,l){n(l,2,0,l.component.propertiesBuyer)},null)}function A(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"h5",[],null,null,null,null,null)),(n()(),e.hb(-1,null,[" No cuentas con propiedades adquiridas para generar chat "]))],null,null)}function Y(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"ion-spinner",[["name","bubbles"]],null,null,null,S.kb,S.P)),e.Pa(1,49152,null,0,C.Pa,[e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"bubbles")},null)}function $(n){return e.jb(0,[(n()(),e.Ha(16777216,null,null,1,null,A)),e.Pa(1,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,null,1,null,Y)),e.Pa(3,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(0,null,null,0))],function(n,l){var t=l.component;n(l,1,0,0===t.propertiesBuyer.length&&t.isLoad),n(l,3,0,0===t.propertiesBuyer.length&&!t.isLoad)},null)}function L(n){return e.jb(0,[(n()(),e.Ha(16777216,null,null,1,null,R)),e.Pa(1,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(n()(),e.Ha(0,[["notBlue",2]],null,0,null,$))],function(n,l){n(l,1,0,l.component.propertiesBuyer.length>0,e.ab(l,2))},null)}function F(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,2,"ion-card-title",[["text-wrap",""]],null,null,null,S.Da,S.j)),e.Pa(1,49152,null,0,C.l,[e.k],null,null),(n()(),e.hb(2,0,["",""]))],null,function(n,l){n(l,2,0,l.parent.context.$implicit.prop.name)})}function D(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"ion-icon",[["name","mail"],["slot","end"]],null,null,null,S.Pa,S.u)),e.Pa(1,49152,null,0,C.A,[e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"mail")},null)}function N(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,2,"ion-badge",[["color","danger"],["id","badge"]],null,null,null,S.X,S.c)),e.Pa(1,49152,null,0,C.e,[e.k],{color:[0,"color"]},null),(n()(),e.hb(2,0,["",""]))],function(n,l){n(l,1,0,"danger")},function(n,l){n(l,2,0,l.parent.context.$implicit.noRead)})}function z(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,22,"ion-card",[["class","state-azul"]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.goToRoom(n.context.$implicit.property)&&e),e},S.Ea,S.f)),e.Pa(1,49152,null,0,C.h,[e.k],null,null),(n()(),e.Qa(2,0,null,0,10,"ion-card-header",[],null,null,null,S.Ba,S.h)),e.Pa(3,49152,null,0,C.j,[e.k],null,null),(n()(),e.Qa(4,0,null,0,8,"ion-item",[["lines","none"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==e.ab(n,6).onClick(t)&&u),u},S.Sa,S.x)),e.Pa(5,49152,null,0,C.F,[e.k],{lines:[0,"lines"]},null),e.Pa(6,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Ha(16777216,null,0,1,null,F)),e.Pa(8,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,0,1,null,D)),e.Pa(10,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,0,1,null,N)),e.Pa(12,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Qa(13,0,null,0,9,"ion-card-content",[["class","content-card-chat"]],null,null,null,S.Aa,S.g)),e.Pa(14,49152,null,0,C.i,[e.k],null,null),(n()(),e.Qa(15,0,null,0,7,"ion-item",[["lines","none"]],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==e.ab(n,17).onClick(t)&&u),u},S.Sa,S.x)),e.Pa(16,49152,null,0,C.F,[e.k],{lines:[0,"lines"]},null),e.Pa(17,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(18,0,null,0,1,"ion-icon",[["name","arrow-forward"],["slot","end"],["style","color:  #F5811E"]],null,null,null,S.Pa,S.u)),e.Pa(19,49152,null,0,C.A,[e.k],{name:[0,"name"]},null),(n()(),e.Qa(20,0,null,0,2,"ion-label",[["text-wrap",""]],null,null,null,S.Ta,S.y)),e.Pa(21,49152,null,0,C.L,[e.k],null,null),(n()(),e.hb(-1,0,["Chat de la propiedad"]))],function(n,l){n(l,5,0,"none"),n(l,8,0,l.context.$implicit.prop),n(l,10,0,l.context.$implicit.noRead>0),n(l,12,0,l.context.$implicit.noRead>0),n(l,16,0,"none"),n(l,19,0,"arrow-forward")},null)}function U(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,2,"div",[["class","my-contenet"]],null,null,null,null,null)),(n()(),e.Ha(16777216,null,null,1,null,z)),e.Pa(2,278528,null,0,Q.j,[e.P,e.M,e.s],{ngForOf:[0,"ngForOf"]},null)],function(n,l){n(l,2,0,l.component.chats)},null)}function X(n){return e.jb(0,[(n()(),e.Ha(16777216,null,null,1,null,U)),e.Pa(1,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(0,null,null,0))],function(n,l){n(l,1,0,l.component.isLoad)},null)}function G(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,10,"ion-header",[],null,null,null,S.Oa,S.t)),e.Pa(1,49152,null,0,C.y,[e.k],null,null),(n()(),e.Qa(2,0,null,0,8,"ion-toolbar",[["color","primary"]],null,null,null,S.pb,S.T)),e.Pa(3,49152,null,0,C.Xa,[e.k],{color:[0,"color"]},null),(n()(),e.Qa(4,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,S.Z,S.e)),e.Pa(5,49152,null,0,C.g,[],null,null),(n()(),e.Qa(6,0,null,0,1,"ion-menu-button",[["style","color: white"]],null,null,null,S.Wa,S.C)),e.Pa(7,49152,null,0,C.P,[e.k],null,null),(n()(),e.Qa(8,0,null,0,2,"ion-title",[],null,null,null,S.ob,S.U)),e.Pa(9,49152,null,0,C.Ya,[e.k],null,null),(n()(),e.hb(-1,0,[" Chat "])),(n()(),e.Qa(11,0,null,null,5,"ion-content",[["padding",""]],null,null,null,S.Ja,S.o)),e.Pa(12,49152,null,0,C.r,[e.k],null,null),(n()(),e.Ha(16777216,null,0,1,null,H)),e.Pa(14,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"],ngIfThen:[1,"ngIfThen"],ngIfElse:[2,"ngIfElse"]},null),(n()(),e.Ha(0,[["Buyer",2]],0,0,null,L)),(n()(),e.Ha(0,[["NoBuyer",2]],0,0,null,X))],function(n,l){var t=l.component;n(l,3,0,"primary"),n(l,14,0,"buyer"===t.user.type||"preBuyer"===t.user.type,e.ab(l,15),e.ab(l,16))},null)}var q=e.Ma("app-chat",b,function(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"app-chat",[],null,null,null,G,O)),e.Pa(1,114688,null,0,b,[u.a,i.a,s,M.l,p.a,h.a,f.a,d.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),J=t("gIcY"),K=e.Oa({encapsulation:0,styles:[['.ta-frame[_ngcontent-%COMP%]{margin:0;padding:10px;width:230px;height:20px;border-top:1px solid gray;background-color:#eee}.textarea-chat[_ngcontent-%COMP%]{overflow:hidden;background-color:#fff;color:#000;width:calc(100% - 10px);border:0;border-radius:12px}.speech-bubble-you[_ngcontent-%COMP%]{position:relative;background:silver;border-radius:.4em}.bubble[_ngcontent-%COMP%]{border-radius:5px;box-shadow:0 0 6px #b2b2b2;padding:9px 18px;position:relative;vertical-align:top}.bubble[_ngcontent-%COMP%]::before{content:"\\00a0";display:block;height:16px;position:absolute;top:11px;transform:rotate(29deg) skew(-35deg);-moz-transform:rotate(29deg) skew(-35deg);-ms-transform:rotate(29deg) skew(-35deg);-o-transform:rotate(29deg) skew(-35deg);-webkit-transform:rotate(29deg) skew(-35deg);width:20px}.you[_ngcontent-%COMP%]{margin:1px 45px 1px 20px;background-color:#3c4252;color:#fff}.me[_ngcontent-%COMP%]{margin:1px 20px;color:rgba(0,0,0,.87);background-color:#e0e0e0}.flex-contenet[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-item-you[_ngcontent-%COMP%]{max-width:250px;align-self:flex-start}.flex-item-me[_ngcontent-%COMP%]{max-width:250px;align-self:flex-end}small[_ngcontent-%COMP%]{margin:18%}.item-bottom[_ngcontent-%COMP%]{margin-bottom:8px}.icon-flex[_ngcontent-%COMP%]{position:relative;top:36px;font-size:1.6em;right:8px}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:0}']],data:{}});function Z(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,6,"ion-chip",[["color","secondary"]],null,null,null,S.Ha,S.l)),e.Pa(1,49152,null,0,C.n,[e.k],{color:[0,"color"]},null),(n()(),e.Qa(2,0,null,0,1,"ion-chip-icon",[["class","icon-chip-detail"],["name","person"]],null,null,null,S.Ga,S.m)),e.Pa(3,49152,null,0,C.p,[e.k],{name:[0,"name"]},null),(n()(),e.Qa(4,0,null,0,2,"ion-label",[],null,null,null,S.Ta,S.y)),e.Pa(5,49152,null,0,C.L,[e.k],null,null),(n()(),e.hb(6,0,[""," ",""]))],function(n,l){n(l,1,0,"secondary"),n(l,3,0,"person")},function(n,l){var t=l.component;n(l,6,0,t.buyer.name,t.buyer.fatherLastName)})}function W(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,6,"ion-chip",[["color","secondary"]],null,null,null,S.Ha,S.l)),e.Pa(1,49152,null,0,C.n,[e.k],{color:[0,"color"]},null),(n()(),e.Qa(2,0,null,0,1,"ion-chip-icon",[["class","icon-chip-detail"],["name","business"]],null,null,null,S.Ga,S.m)),e.Pa(3,49152,null,0,C.p,[e.k],{name:[0,"name"]},null),(n()(),e.Qa(4,0,null,0,2,"ion-label",[],null,null,null,S.Ta,S.y)),e.Pa(5,49152,null,0,C.L,[e.k],null,null),(n()(),e.hb(6,0,[""," "]))],function(n,l){n(l,1,0,"secondary"),n(l,3,0,"business")},function(n,l){n(l,6,0,l.component.seller.name)})}function V(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,6,"ion-toolbar",[],null,null,null,S.pb,S.T)),e.Pa(1,49152,null,0,C.Xa,[e.k],null,null),(n()(),e.Qa(2,0,null,0,4,"div",[],null,null,null,null,null)),(n()(),e.Ha(16777216,null,null,1,null,Z)),e.Pa(4,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,null,1,null,W)),e.Pa(6,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,4,0,t.buyer),n(l,6,0,void 0!==t.seller)},null)}function nn(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"ion-icon",[["class","icon-flex"],["name","contact"]],null,null,null,S.Pa,S.u)),e.Pa(1,49152,null,0,C.A,[e.k],{name:[0,"name"]},null)],function(n,l){n(l,1,0,"contact")},null)}function ln(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"small",[],null,null,null,null,null)),(n()(),e.hb(1,null,["",""]))],null,function(n,l){n(l,1,0,"buyer"===l.parent.context.$implicit.typeOfUser?"comprador":"seller"===l.parent.context.$implicit.typeOfUser?"vendedor":"preBuyer"===l.parent.context.$implicit.typeOfUser?"comprador":"administrador")})}function tn(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,12,"span",[["class","item-bottom   "]],null,null,null,null,null)),e.Pa(1,278528,null,0,Q.i,[e.s,e.t,e.k,e.E],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.db(2,{"flex-item-me":0,"flex-item-you":1,"animated zoomInUp delay-1s":2}),(n()(),e.Ha(16777216,null,null,1,null,nn)),e.Pa(4,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Qa(5,0,null,null,4,"div",[["class","bubble "]],null,null,null,null,null)),e.Pa(6,278528,null,0,Q.i,[e.s,e.t,e.k,e.E],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e.db(7,{you:0,me:1}),(n()(),e.Qa(8,0,null,null,1,"div",[],null,null,null,null,null)),(n()(),e.hb(9,null,["",""])),(n()(),e.Ha(16777216,null,null,1,null,ln)),e.Pa(11,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.hb(12,null,[" "," "]))],function(n,l){var t=l.component;n(l,1,0,"item-bottom   ",n(l,2,0,t.user.id===l.context.$implicit.uid,t.user.id!==l.context.$implicit.uid,t.isSending&&l.context.last)),n(l,4,0,t.user.id!==l.context.$implicit.uid),n(l,6,0,"bubble ",n(l,7,0,t.user.id!==l.context.$implicit.uid,t.user.id===l.context.$implicit.uid)),n(l,11,0,t.user.id!==l.context.$implicit.uid)},function(n,l){var t=l.component;n(l,9,0,l.context.$implicit.content),n(l,12,0,l.context.last?t.lastScroll(l.context.index):"")})}function en(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"h5",[],null,null,null,null,null)),(n()(),e.hb(-1,null,["Escriba una pregunta"]))],null,null)}function un(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,5,"div",[],null,null,null,null,null)),(n()(),e.Qa(1,0,null,null,2,"div",[["class","flex-contenet"],["id","flex-contenet"]],null,null,null,null,null)),(n()(),e.Ha(16777216,null,null,1,null,tn)),e.Pa(3,278528,null,0,Q.j,[e.P,e.M,e.s],{ngForOf:[0,"ngForOf"],ngForTrackBy:[1,"ngForTrackBy"]},null),(n()(),e.Ha(16777216,null,null,1,null,en)),e.Pa(5,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,3,0,t.chat.messages,t.trackByCreated),n(l,5,0,0===t.chat.messages.length)},null)}function rn(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,4,"ion-button",[],null,[[null,"click"]],function(n,l,t){var u=!0,i=n.component;return"click"===l&&(u=!1!==e.ab(n,2).onClick(t)&&u),"click"===l&&(u=!1!==i.submit()&&u),u},S.Y,S.d)),e.Pa(1,49152,null,0,C.f,[e.k],null,null),e.Pa(2,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(3,0,null,0,1,"ion-icon",[["name","send"],["slot","icon-only"]],null,null,null,S.Pa,S.u)),e.Pa(4,49152,null,0,C.A,[e.k],{name:[0,"name"]},null)],function(n,l){n(l,4,0,"send")},null)}function on(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,4,"ion-button",[],null,[[null,"click"]],function(n,l,t){var u=!0;return"click"===l&&(u=!1!==e.ab(n,2).onClick(t)&&u),u},S.Y,S.d)),e.Pa(1,49152,null,0,C.f,[e.k],null,null),e.Pa(2,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(3,0,null,0,1,"ion-spinner",[["color","secondary"],["name","dots"],["slot","icon-only"]],null,null,null,S.kb,S.P)),e.Pa(4,49152,null,0,C.Pa,[e.k],{color:[0,"color"],name:[1,"name"]},null)],function(n,l){n(l,4,0,"secondary","dots")},null)}function an(n){return e.jb(0,[e.fb(402653184,1,{content:0}),e.fb(402653184,2,{myInput:0}),(n()(),e.Qa(2,0,null,null,15,"ion-header",[],null,null,null,S.Oa,S.t)),e.Pa(3,49152,null,0,C.y,[e.k],null,null),(n()(),e.Qa(4,0,null,0,11,"ion-toolbar",[["color","primary"]],null,null,null,S.pb,S.T)),e.Pa(5,49152,null,0,C.Xa,[e.k],{color:[0,"color"]},null),(n()(),e.Qa(6,0,null,0,6,"ion-buttons",[["slot","start"]],null,null,null,S.Z,S.e)),e.Pa(7,49152,null,0,C.g,[],null,null),(n()(),e.Qa(8,0,null,0,4,"ion-button",[["slot","start"]],null,[[null,"click"]],function(n,l,t){var u=!0,i=n.component;return"click"===l&&(u=!1!==e.ab(n,10).onClick(t)&&u),"click"===l&&(u=!1!==i.backOne()&&u),u},S.Y,S.d)),e.Pa(9,49152,null,0,C.f,[e.k],null,null),e.Pa(10,16384,null,0,j.a,[[2,M.l],e.k],null,null),(n()(),e.Qa(11,0,null,0,1,"ion-icon",[["name","arrow-back"],["slot","icon-only"],["style","color: white"]],null,null,null,S.Pa,S.u)),e.Pa(12,49152,null,0,C.A,[e.k],{name:[0,"name"]},null),(n()(),e.Qa(13,0,null,0,2,"ion-title",[],null,null,null,S.ob,S.U)),e.Pa(14,49152,null,0,C.Ya,[e.k],null,null),(n()(),e.hb(15,0,[" Chat "," "])),(n()(),e.Ha(16777216,null,0,1,null,V)),e.Pa(17,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Qa(18,0,null,null,4,"ion-content",[["padding",""]],null,null,null,S.Ja,S.o)),e.Pa(19,49152,[[1,4]],0,C.r,[e.k],null,null),(n()(),e.Qa(20,0,null,0,2,"div",[["class","my-contenet-chat"]],null,null,null,null,null)),(n()(),e.Ha(16777216,null,null,1,null,un)),e.Pa(22,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Qa(23,0,null,null,17,"ion-footer",[],null,null,null,S.Ma,S.r)),e.Pa(24,49152,null,0,C.w,[e.k],null,null),(n()(),e.Qa(25,0,null,0,15,"ion-toolbar",[["color","primary"]],null,null,null,S.pb,S.T)),e.Pa(26,49152,null,0,C.Xa,[e.k],{color:[0,"color"]},null),(n()(),e.Qa(27,0,[[2,0],["myInput",1]],0,7,"textarea",[["class","textarea-chat"],["id","myInput"],["maxlength","500"],["rows","1"]],[[1,"maxlength",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"keyup"],[null,"ngModelChange"],[null,"keydown.enter"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(n,l,t){var u=!0,i=n.component;return"input"===l&&(u=!1!==e.ab(n,28)._handleInput(t.target.value)&&u),"blur"===l&&(u=!1!==e.ab(n,28).onTouched()&&u),"compositionstart"===l&&(u=!1!==e.ab(n,28)._compositionStart()&&u),"compositionend"===l&&(u=!1!==e.ab(n,28)._compositionEnd(t.target.value)&&u),"keyup"===l&&(u=!1!==i.textAreaKeyup()&&u),"ngModelChange"===l&&(u=!1!==(i.contentText=t)&&u),"keydown.enter"===l&&(u=!1!==i.submit()&&u),u},null,null)),e.Pa(28,16384,null,0,J.d,[e.E,e.k,[2,J.a]],null,null),e.Pa(29,540672,null,0,J.g,[],{maxlength:[0,"maxlength"]},null),e.eb(1024,null,J.h,function(n){return[n]},[J.g]),e.eb(1024,null,J.i,function(n){return[n]},[J.d]),e.Pa(32,671744,null,0,J.n,[[8,null],[6,J.h],[8,null],[6,J.i]],{model:[0,"model"]},{update:"ngModelChange"}),e.eb(2048,null,J.j,null,[J.n]),e.Pa(34,16384,null,0,J.k,[[4,J.j]],null,null),(n()(),e.Qa(35,0,null,0,5,"ion-buttons",[["slot","end"]],null,null,null,S.Z,S.e)),e.Pa(36,49152,null,0,C.g,[],null,null),(n()(),e.Ha(16777216,null,0,1,null,rn)),e.Pa(38,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null),(n()(),e.Ha(16777216,null,0,1,null,on)),e.Pa(40,16384,null,0,Q.k,[e.P,e.M],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component;n(l,5,0,"primary"),n(l,12,0,"arrow-back"),n(l,17,0,"buyer"!==t.user.type),n(l,22,0,t.isLoad),n(l,26,0,"primary"),n(l,29,0,"500"),n(l,32,0,t.contentText),n(l,38,0,!1!==t.isSending),n(l,40,0,!1===t.isSending)},function(n,l){n(l,15,0,l.component.title),n(l,27,0,e.ab(l,29).maxlength?e.ab(l,29).maxlength:null,e.ab(l,34).ngClassUntouched,e.ab(l,34).ngClassTouched,e.ab(l,34).ngClassPristine,e.ab(l,34).ngClassDirty,e.ab(l,34).ngClassValid,e.ab(l,34).ngClassInvalid,e.ab(l,34).ngClassPending)})}var cn=e.Ma("app-chat-room",I,function(n){return e.jb(0,[(n()(),e.Qa(0,0,null,null,1,"app-chat-room",[],null,null,null,an,K)),e.Pa(1,245760,null,0,I,[M.a,s,u.a,h.a,d.a,y.a,P.a,p.a,M.l,v.a],null,null)],function(n,l){n(l,1,0)},null)},{},{},[]),sn=t("95zI"),pn=t("9opb"),hn=t("apKv"),fn=t("B4/3");t.d(l,"ChatPageModuleNgFactory",function(){return dn});var dn=e.Na(B,[],function(n){return e.Xa([e.Ya(512,e.j,e.Ca,[[8,[w.a,q,cn]],[3,e.j],e.x]),e.Ya(4608,Q.m,Q.l,[e.u,[2,Q.x]]),e.Ya(4608,J.t,J.t,[]),e.Ya(4608,sn.a,sn.a,[e.z,e.g]),e.Ya(4608,pn.a,pn.a,[sn.a,e.j,e.r]),e.Ya(4608,hn.a,hn.a,[sn.a,e.j,e.r]),e.Ya(1073742336,Q.c,Q.c,[]),e.Ya(1073742336,J.q,J.q,[]),e.Ya(1073742336,J.f,J.f,[]),e.Ya(1073742336,fn.a,fn.a,[]),e.Ya(1073742336,M.n,M.n,[[2,M.t],[2,M.l]]),e.Ya(1073742336,B,B,[]),e.Ya(1024,M.j,function(){return[[{path:"",component:b},{path:"room",component:I}]]},[])])})}}]);