{"version":3,"sources":["webpack:///./src/app/components/chat/chat-room/chat-room.component.html","webpack:///./src/app/components/chat/chat-room/chat-room.component.scss","webpack:///./src/app/components/chat/chat-room/chat-room.component.ts","webpack:///./src/app/components/chat/chat.module.ts","webpack:///./src/app/components/chat/chat.page.html","webpack:///./src/app/components/chat/chat.page.scss","webpack:///./src/app/components/chat/chat.page.ts","webpack:///./src/app/services/chat.service.ts"],"names":[],"mappings":";;;;;;;;;AAAA,sWAAsW,SAAS,4PAA4P,cAAc,GAAG,wBAAwB,iNAAiN,eAAe,iXAAiX,sCAAsC,8BAA8B,kEAAkE,+KAA+K,8OAA8O,oDAAoD,oCAAoC,eAAe,6EAA6E,yQAAyQ,sBAAsB,6BAA6B,63B;;;;;;;;;;;ACAxvE,6BAA6B,cAAc,uBAAuB,iBAAiB,iBAAiB,+BAA+B,2BAA2B,EAAE,oBAAoB,qBAAqB,4BAA4B,iBAAiB,6BAA6B,cAAc,wBAAwB,EAAE,wBAAwB,uBAAuB,wBAAwB,wBAAwB,EAAE,aAAa,uBAAuB,gCAAgC,sBAAsB,uBAAuB,wBAAwB,EAAE,qBAAqB,wBAAwB,mBAAmB,iBAAiB,uBAAuB,cAAc,0CAA0C,+CAA+C,8CAA8C,6CAA6C,kDAAkD,gBAAgB,EAAE,UAAU,8BAA8B,iCAAiC,mBAAmB,iCAAiC,gBAAgB,EAAE,qBAAqB,yDAAyD,iBAAiB,gCAAgC,GAAG,YAAY,8BAA8B,iCAAiC,mBAAmB,kCAAkC,8BAA8B,EAAE,oBAAoB,yDAAyD,kBAAkB,gCAAgC,KAAK,uBAAuB,kBAAkB,2BAA2B,EAAE,oBAAoB,qBAAqB,2BAA2B,EAAE,mBAAmB,qBAAqB,yBAAyB,EAAE,WAAW,gBAAgB,EAAE,kBAAkB,uBAAuB,EAAE,gBAAgB,uBAAuB,cAAc,qBAAqB,eAAe,EAAE,kCAAkC,kBAAkB,EAAE,G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACO31D;AACkC;AACI;AAGpB;AACmC;AAEP;AACC;AACC;AAErB;AACe;AAGF;AAEO;AAOtE;IAoBE,2BACU,KAAqB,EACrB,WAAwB,EACxB,WAA+B,EAC/B,eAAgC,EAChC,eAAgC,EAChC,aAA8B,EAC9B,gBAAkC,EAClC,aAA4B,EAC5B,MAAc,EACd,YAA0B;QAVpC,iBAkCC;QAjCS,UAAK,GAAL,KAAK,CAAgB;QACrB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAoB;QAC/B,oBAAe,GAAf,eAAe,CAAiB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAChC,kBAAa,GAAb,aAAa,CAAiB;QAC9B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,kBAAa,GAAb,aAAa,CAAe;QAC5B,WAAM,GAAN,MAAM,CAAQ;QACd,iBAAY,GAAZ,YAAY,CAAc;QAzBpC,aAAQ,GAAG,KAAK,CAAC;QAMjB;;WAEG;QACK,gBAAW,GAA6C,EAAE,CAAC;QAC3D,iBAAY,GAAG,KAAK,CAAC;QAiB3B,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC;QAC1C,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,SAAS,CAAC,UAAM,MAAM;;;;;6BACvC,MAAM,CAAC,EAAE,EAAT,wBAAS;6BACP,KAAI,CAAC,IAAI,CAAC,IAAI,KAAK,UAAU,GAA7B,wBAA6B;wBAC/B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;wBACf,qBAAM,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,EAAE,CAAC;;wBAA/C,IAAI,GAAG,SAAwC;wBACrD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;wBACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;;;wBAEvB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;wBACf,qBAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC;;wBAA5C,IAAI,GAAG,SAAqC;wBAClD,SAAI;wBAAU,qBAAM,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,EAAE,CAAC;;wBAAvD,GAAK,MAAM,GAAG,SAAyC,CAAC;wBACxD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;wBACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;;;;;aAG7C,CAAC,CAAC;QACH,IAAI,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,SAAS,CAAC,gBAAM;YAC5C,IAAI,MAAM,KAAK,KAAI,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC5B,KAAI,CAAC,eAAe,CAAC,KAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACrC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,oCAAQ,GAAR,cAAY,CAAC;IACb,yCAAa,GAAb;QAAA,iBA8BC;QA7BC,qBAAqB;QACrB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC;YACxD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;SAC1B;QACD,yBAAyB;QACzB,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE;YAC3D,+CAA+C;YAC/C,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;gBACpB,KAAK,EAAE,IAAI,CAAC,QAAQ;gBACpB,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC;aACzC,CAAC,CAAC;YACH,sCAAsC;YACtC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC;SACzD;QACD,IAAM,CAAC,GAAG,IAAI,CAAC,WAAW,CAAC,SAAS,CAClC,YAAE,IAAI,SAAE,CAAC,WAAW,KAAK,KAAI,CAAC,WAAW,CAAC,MAAM,EAA1C,CAA0C,CACjD,CAAC;QACF,wCAAwC;QACxC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YACZ,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM;gBACrC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;YACnC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,CAAC;SACzD;aAAM;YACL,uCAAuC;YACvC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM;gBACrC,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;SAClD;IACH,CAAC;IAED,uCAAW,GAAX,UAAY,EAAE;QAAd,iBAaC;QAZC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,UAAM,IAAI;;;;;6BAC7C,KAAI,KAAK,IAAI,GAAb,wBAAa;wBACf,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;;;wBAEjB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;wBACjB,SAAI;wBAAS,qBAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC;;wBAAhD,GAAK,KAAK,GAAG,SAAmC,CAAC;wBAEjD,IAAI,CAAC,YAAY,EAAE,CAAC;wBACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;;;;;aAEtB,CAAC,CAAC;IACL,CAAC;IACD,2CAAe,GAAf,UAAgB,EAAE;QAAlB,iBAQC;QAPC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,cAAI;YAC7C,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,KAAI,CAAC,YAAY,EAAE,CAAC;YACpB,KAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,KAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACpB,CAAC,CAAC,CAAC;IACL,CAAC;IACK,2CAAe,GAArB,UAAsB,EAAE;;;;;4BACX,qBAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE;;wBAAjE,IAAI,GAAG,SAA0D;6BACjE,KAAI,KAAK,IAAI,GAAb,wBAAa;wBACf,sBAAO,IAAI,EAAC;4BAEL,qBAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE;;wBAA9D,IAAI,GAAG,SAAuD,CAAC;wBAC/D,sBAAO,IAAI,EAAC;;;;KAEf;IACK,8CAAkB,GAAxB,UAAyB,MAAM;;;;4BACtB,qBAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE;4BAAlE,sBAAO,SAA2D,EAAC;;;;KACpE;IACK,kCAAM,GAAZ;;;;;;;wBACE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;wBACjB,UAAU,GAAa;4BAC3B,OAAO,EAAE,IAAI,CAAC,WAAW;4BACzB,QAAQ,EAAE,IAAI,IAAI,EAAE;4BACpB,MAAM,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;4BACtB,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;4BACjB,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI;yBAC3B,CAAC;wBACU,qBAAM,IAAI,CAAC,WAAW;iCAC/B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,UAAU,CAAC;iCACjC,SAAS,EAAE;;wBAFR,GAAG,GAAG,SAEE;6BACV,GAAG,EAAH,wBAAG;wBAEU,qBAAM,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;;wBAA1D,MAAM,GAAG,SAAiD;wBAC5D,WAAW,GAAG,EAAE,CAAC;wBACrB,IAAI,MAAM,KAAK,SAAS,EAAE;4BACxB,WAAW,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;yBACjC;6BAAM;4BACL,WAAW,GAAG,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;yBAC7C;wBACK,SAAS,GAAG,WAAW,CAAC,SAAS,CAAC,YAAE,IAAI,SAAE,KAAK,KAAI,CAAC,IAAI,CAAC,EAAE,EAAnB,CAAmB,CAAC,CAAC;wBACnE,IAAI,SAAS,KAAK,CAAC,CAAC,EAAE;4BACpB,WAAW,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;yBAClC;wBACD,IAAI,CAAC,YAAY,CACf,eAAe,EACZ,IAAI,CAAC,IAAI,CAAC,IAAI,UAAK,IAAI,CAAC,WAAa,EACxC,OAAO,EACP,KAAK,EACL,CAAC,QAAQ,EAAE,YAAY,CAAC,EACxB,WAAW,CACZ,CAAC;;;wBAEJ,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC/B,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM;gCACrC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;4BACnC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;yBAC7B;wBACD,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC,IAAI,EAAE,CAAC;wBAC7B,IAAI,CAAC,YAAY,EAAE,CAAC;;;;;KACrB;IACD,mCAAO,GAAP,UAAQ,MAAM;QAAd,iBAKC;QAJC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,SAAS,CAAC,cAAI;YAC3D,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,KAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACrB,CAAC,CAAC,CAAC;IACL,CAAC;IACD,0CAAc,GAAd,UAAe,GAAa;QAC1B,OAAO,GAAG,CAAC,QAAQ,CAAC;IACtB,CAAC;IACD,wCAAY,GAAZ;QAAA,iBAKC;QAJC,iCAAiC;QACjC,UAAU,CAAC;YACT,KAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;QAChC,CAAC,EAAE,EAAE,CAAC,CAAC;IACT,CAAC;IACD,sCAAU,GAAV,UAAW,CAAC;QAAZ,iBAQC;QAPC,kBAAkB;QAClB,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;YACzD,UAAU,CAAC;gBACT,KAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;YAChC,CAAC,EAAE,EAAE,CAAC,CAAC;YACP,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACtB;IACH,CAAC;IACD,WAAW;IACJ,wCAAY,GAAnB,UACE,KAAK,EACL,OAAO,EACP,MAAM,EACN,IAAI,EACJ,IAAI,EACJ,UAAoB;QANtB,iBAyBC;QAjBC,eAAe;QACf,IAAM,YAAY,GAAkB;YAClC,KAAK,EAAE,KAAK;YACZ,OAAO,EAAE,OAAO;YAChB,IAAI,EAAE,IAAI;YACV,WAAW,EAAE,UAAU;YACvB,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;YAC/C,MAAM,EAAE,MAAM;YACd,IAAI,EAAE,IAAI;SACX,CAAC;QACF,YAAY;QACZ,IAAI,CAAC,gBAAgB;aAClB,kBAAkB,CAAC,YAAY,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,CAAC;aACjE,SAAS,CAAC;YACT,eAAe;YACf,KAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC,SAAS,EAAE,CAAC;QAClE,CAAC,CAAC,CAAC;IACP,CAAC;IACK,+CAAmB,GAAzB,UAA0B,EAAE;;;;4BACnB,qBAAM,IAAI,CAAC,aAAa;6BAC5B,YAAY,EAAE;6BACd,IAAI,CACH,uEAAG,CAAC,iBAAO,IAAI,cAAO,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,GAAG,KAAK,EAAE,EAAZ,CAAY,CAAC,EAApC,CAAoC,CAAC,EAAvD,CAAuD,CAAC,CACxE;6BACA,SAAS,EAAE;4BALd,sBAAO,SAKO,EAAC;;;;KAChB;IACK,wCAAY,GAAlB,UAAmB,OAAO;;;;4BACjB,qBAAM,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE;4BAAhE,sBAAO,SAAyD,EAAC;;;;KAClE;IACO,mCAAO,GAAf;QAAA,iBAMC;QALC,IAAM,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ;aAC3B,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,KAAK,KAAI,CAAC,IAAI,CAAC,EAAE,EAAlB,CAAkB,CAAC,EAAvC,CAAuC,CAAC;aACpD,GAAG,CAAC,aAAG,IAAI,UAAG,CAAC,GAAG,EAAP,CAAO,CAAC,CAAC;QAEvB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC;IACzE,CAAC;IACD,uCAAW,GAAX;QACE,IAAI,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IACD,mCAAO,GAAP;QAAA,iBAIC;QAHC,IAAI,CAAC,MAAM;aACR,aAAa,CAAC,kBAAkB,EAAE,EAAE,kBAAkB,EAAE,IAAI,EAAE,CAAC;aAC/D,IAAI,CAAC,cAAM,YAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,CAAC,EAA9B,CAA8B,CAAC,CAAC;IAChD,CAAC;IAlOmB;QAAnB,+DAAS,CAAC,sDAAO,CAAC;kCAAU,sDAAO;sDAAC;IACf;QAArB,+DAAS,CAAC,SAAS,CAAC;kCAAU,wDAAU;sDAAC;IAjB/B,iBAAiB;QAL7B,+DAAS,CAAC;YACT,QAAQ,EAAE,eAAe;;;SAG1B,CAAC;yCAsBiB,8DAAc;YACR,kEAAW;YACX,iFAAkB;YACd,0EAAe;YACf,4EAAe;YACjB,2EAAe;YACZ,4EAAgB;YACnB,sEAAa;YACpB,sDAAM;YACA,qEAAY;OA9BzB,iBAAiB,CAmP7B;IAAD,wBAAC;CAAA;AAnP6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChCW;AACM;AACF;AACU;AAEV;AAEN;AAC6B;AAEpE,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,mDAAQ;KACpB;IACD;QACE,IAAI,EAAE,MAAM;QACZ,SAAS,EAAE,gFAAiB;KAC7B;CACF,CAAC;AAWF;IAAA;IAA6B,CAAC;IAAjB,cAAc;QAT1B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,mDAAQ,EAAE,gFAAiB,CAAC;SAC5C,CAAC;OACW,cAAc,CAAG;IAAD,qBAAC;CAAA;AAAH;;;;;;;;;;;;AC9B3B,6WAA6W,oBAAoB,oKAAoK,yGAAyG,wNAAwN,sKAAsK,sBAAsB,4LAA4L,2CAA2C,0tCAA0tC,8CAA8C,4LAA4L,2CAA2C,mf;;;;;;;;;;;ACAxvF,sCAAsC,2CAA2C,EAAE,YAAY,uBAAuB,aAAa,eAAe,uBAAuB,EAAE,G;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAzH;AACuB;AAEiB;AACrD;AAMqB;AACC;AAEG;AACI;AACC;AACA;AAOnE;IAKE,kBACU,kBAAsC,EACtC,eAA2C,EAC3C,WAAwB,EACxB,MAAc,EACd,aAA4B,EAC5B,eAAgC,EAChC,eAAgC,EAChC,eAAgC;QAPhC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAA4B;QAC3C,gBAAW,GAAX,WAAW,CAAa;QACxB,WAAM,GAAN,MAAM,CAAQ;QACd,kBAAa,GAAb,aAAa,CAAe;QAC5B,oBAAe,GAAf,eAAe,CAAiB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAChC,oBAAe,GAAf,eAAe,CAAiB;QAX1C,oBAAe,GAAG,EAAE,CAAC;QACrB,UAAK,GAAU,EAAE,CAAC;QAYhB,IAAI,CAAC,IAAI,GAAG,kBAAkB,CAAC,WAAW,CAAC,KAAK,CAAC;IACnD,CAAC;IAED,2BAAQ,GAAR;QACE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;YAC9B,IAAI,CAAC,SAAS,EAAE,CAAC;SAClB;aAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,UAAU,EAAE;YACxC,IAAI,CAAC,WAAW,EAAE,CAAC;SACpB;aAAM;YACL,IAAI,CAAC,kBAAkB,EAAE,CAAC;SAC3B;IACH,CAAC;IACD,8BAAW,GAAX;QAAA,iBAiBC;QAhBC,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,eAAK;YAC7D,IAAM,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CACxC,eAAK,IAAI,QAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,CAAC,UAAU,EAAb,CAAa,CAAC,EAAxC,CAAwC,CAClD,CAAC;YACF,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC1B,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC3B,YAAY,CAAC,OAAO,CAAC,UAAM,KAAK;;;;;gCAC9B,eAAI,CAAC,eAAe,EAAC,IAAI;;oCACvB,MAAM,EAAE,MAAM;oCACd,QAAQ,EAAE,EAAE,GAAG,EAAE,KAAK,CAAC,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE;;gCACtC,qBAAM,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,GAAG,CAAC;;gCAHnD,eAGE,SAAM,GAAE,SAAyC;6CACjD,CAAC;;;;qBACJ,CAAC,CAAC;gBACH,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,eAAe,CAAC,CAAC;aACnC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IACD,4BAAS,GAAT;QAAA,iBAaC;QAZC,kBAAkB;QAClB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,eAAe;aACjB,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;aACzB,IAAI,CAAC,0DAAG,CAAC,aAAG,IAAI,UAAG,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,MAAM,KAAK,MAAM,EAAnB,CAAmB,CAAC,EAApC,CAAoC,CAAC,CAAC;aACtD,SAAS,CAAC,YAAE;YACX,KAAI,CAAC,eAAe,GAAG,EAAE,CAAC;YAC1B,KAAI,CAAC,eAAe,CAAC,GAAG,CAAC,UAAM,GAAG;;;;;4BAChC,QAAG;4BAAC,aAAQ;4BAAI,qBAAM,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC;;4BAAhE,MAAa,GAAG,SAAgD,CAAC;;;;iBAClE,CAAC,CAAC;YACH,KAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QACrB,CAAC,CAAC,CAAC;IACP,CAAC;IACD,qCAAkB,GAAlB;QAAA,iBAyBC;QAxBC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,UAAM,QAAQ;;;;;;wBAChD,QAAQ,CAAC,OAAO,CAAC,cAAI;4BACnB,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;wBAC5C,CAAC,CAAC,CAAC;6BAEC,KAAI,CAAC,IAAI,CAAC,IAAI,KAAK,QAAQ,GAA3B,wBAA2B;wBACd,qBAAM,IAAI,CAAC,SAAS,EAAE;;wBAA/B,WAAS,SAAsB;wBACrC,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,cAAI;4BAC/B,OAAO,QAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,CAAC,GAAG,KAAK,IAAI,CAAC,QAAQ,EAAvB,CAAuB,CAAC,CAAC;wBAC5D,CAAC,CAAC,CAAC;;;wBACE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,YAAY,EAAE;4BAC1C,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,MAAM,CAAC,cAAI;gCAC/B,OAAO,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC;4BAChC,CAAC,CAAC,CAAC;yBACJ;6BAAM;4BACL,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC;yBACvB;;;wBACD,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAM,CAAC;;;;;wCACpB,MAAC;wCAAC,aAAQ;wCAAI,qBAAM,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC,QAAQ,CAAC;;wCAAxD,MAAW,GAAG,SAA0C,CAAC;wCACzD,MAAC;wCAAC,WAAM;wCAAI,qBAAM,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,QAAQ,CAAC;;wCAA9C,MAAS,GAAG,SAAkC,CAAC;;;;6BAChD,CAAC,CAAC;wBACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;;;;aACpB,CAAC,CAAC;IACL,CAAC;IACK,sCAAmB,GAAzB,UAA0B,MAAc;;;;;;4BACzB,qBAAM,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE;;wBAA3D,IAAI,GAAG,SAAoD;wBACjE,IAAI,IAAI,KAAK,IAAI,EAAE;4BACjB,sBAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAC,IAAI,QAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,WAAC,IAAI,QAAC,KAAK,KAAI,CAAC,IAAI,CAAC,EAAE,EAAlB,CAAkB,CAAC,EAAvC,CAAuC,CAAC;qCACtE,MAAM,EAAC;yBACX;6BAAM;4BACL,sBAAO,CAAC,EAAC;yBACV;;;;;KACF;IACD,2BAAQ,GAAR,UAAS,EAAE;QACT,IAAM,IAAI,GAAqB,EAAE,WAAW,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;QAC3D,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC;IAC5C,CAAC;IACK,4BAAS,GAAf;;;;4BACS,qBAAM,IAAI,CAAC,aAAa,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE;4BAAvE,sBAAO,SAAgE,EAAC;;;;KACzE;IACK,8BAAW,GAAjB,UAAkB,EAAE;;;;;4BACP,qBAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE;;wBAAjE,IAAI,GAAG,SAA0D;6BACjE,KAAI,KAAK,IAAI,GAAb,wBAAa;wBACf,sBAAO,IAAI,EAAC;4BAEL,qBAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE;;wBAA9D,IAAI,GAAG,SAAuD,CAAC;wBAC/D,sBAAO,IAAI,EAAC;;;;KAEf;IACK,8BAAW,GAAjB,UAAkB,MAAM,EAAE,MAAM;;;;;4BACnB,qBAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE;;wBAArE,IAAI,GAAG,SAA8D;6BACrE,KAAI,KAAK,IAAI,GAAb,wBAAa;wBACR,qBAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE;;wBAAlE,IAAI,GAAG,SAA2D,CAAC;wBACnE,IAAI,IAAI,KAAK,IAAI,EAAE;4BACjB,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,SAAS,EAAE,CAAC;yBAClD;;;;;;KAEJ;IAtHU,QAAQ;QALpB,+DAAS,CAAC;YACT,QAAQ,EAAE,UAAU;;;SAGrB,CAAC;yCAO8B,iFAAkB;YACrB,kGAA0B;YAC9B,kEAAW;YAChB,sDAAM;YACC,sEAAa;YACX,0EAAe;YACf,2EAAe;YACf,2EAAe;OAb/B,QAAQ,CAuHpB;IAAD,eAAC;CAAA;AAvHoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvBsB;AACO;AAEA;AACI;AAMtD;IACE,qBAAoB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAG,CAAC;IACjC,4BAAM,GAAb;QACE,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,gEAAS,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IAC3E,CAAC;IACM,+BAAS,GAAhB,UAAiB,UAAkB;QACjC,OAAO,IAAI,CAAC,IAAI;aACb,GAAG,CAAC,gEAAS,CAAC,YAAY,GAAG,UAAU,CAAC;aACxC,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,iCAAW,GAAlB,UAAmB,MAAc;QAC/B,OAAO,IAAI,CAAC,IAAI;aACb,GAAG,CAAC,gEAAS,CAAC,OAAO,GAAG,MAAM,CAAC;aAC/B,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,+BAAS,GAAhB,UAAiB,MAAc;QAC7B,OAAO,IAAI,CAAC,IAAI;aACb,GAAG,CAAC,gEAAS,CAAC,YAAY,GAAG,MAAM,CAAC;aACpC,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,4BAAM,GAAb,UAAc,MAAc,EAAE,WAAqB;QACjD,IAAM,IAAI,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,WAAW,eAAE,CAAC;QAC1C,OAAO,IAAI,CAAC,IAAI;aACb,IAAI,CAAC,gEAAS,CAAC,YAAY,EAAE,IAAI,CAAC;aAClC,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,6BAAO,GAAd,UAAe,MAAc,EAAE,UAAoB,EAAE,GAAG;QACtD,IAAM,IAAI,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,UAAU,cAAE,GAAG,OAAE,CAAC;QAC9C,OAAO,IAAI,CAAC,IAAI;aACb,IAAI,CAAC,gEAAS,CAAC,aAAa,EAAE,IAAI,CAAC;aACnC,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,6BAAO,GAAd,UACE,OAAe,EACf,UAAkB,EAClB,IAAe;QAAf,sCAAe;QAEf,IAAM,IAAI,GAAG;YACX,KAAK,EAAE,OAAO;YACd,QAAQ,EAAE,UAAU;YACpB,IAAI,EAAE,IAAI;YACV,QAAQ,EAAE,EAAE;SACb,CAAC;QACF,OAAO,IAAI,CAAC,IAAI;aACb,IAAI,CAAC,gEAAS,CAAC,IAAI,EAAE,IAAI,CAAC;aAC1B,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IACM,iCAAW,GAAlB,UAAmB,EAAU;QAC3B,OAAO,IAAI,CAAC,IAAI;aACb,MAAM,CAAC,gEAAS,CAAC,IAAI,GAAG,EAAE,CAAC;aAC3B,IAAI,CAAC,uEAAG,CAAC,UAAC,IAAS,IAAK,WAAI,CAAC,IAAI,EAAT,CAAS,CAAC,CAAC,CAAC;IACzC,CAAC;IAnDU,WAAW;QAHvB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;yCAE0B,+DAAU;OADzB,WAAW,CAkGvB;IAAD,kBAAC;CAAA;AAlGuB","file":"components-chat-chat-module.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button (click)=\\\"backOne()\\\" slot=\\\"start\\\">\\n        <ion-icon\\n          style=\\\"color: white\\\"\\n          slot=\\\"icon-only\\\"\\n          name=\\\"arrow-back\\\"\\n        ></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title> Chat {{ title }} </ion-title>\\n  </ion-toolbar>\\n  <ion-toolbar *ngIf=\\\"user.type !== 'buyer'\\\">\\n    <div>\\n      <ion-chip *ngIf=\\\"buyer\\\" color=\\\"secondary\\\">\\n        <ion-chip-icon class=\\\"icon-chip-detail\\\" name=\\\"person\\\"></ion-chip-icon>\\n        <ion-label>{{ buyer.name }} {{ buyer.fatherLastName }}</ion-label>\\n      </ion-chip>\\n      <ion-chip color=\\\"secondary\\\" *ngIf=\\\"seller !== undefined\\\">\\n        <ion-chip-icon class=\\\"icon-chip-detail\\\" name=\\\"business\\\"></ion-chip-icon>\\n        <ion-label>{{ seller.name }} </ion-label>\\n      </ion-chip>\\n    </div>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content padding>\\n  <div class=\\\"my-contenet-chat\\\">\\n    <div *ngIf=\\\"isLoad\\\">\\n      <div class=\\\"flex-contenet\\\" id=\\\"flex-contenet\\\">\\n        <!-- contenido de chat -->\\n        <span\\n          class=\\\"item-bottom   \\\"\\n          *ngFor=\\\"\\n            let msg of chat.messages;\\n            trackBy: trackByCreated;\\n            let last = last;\\n            let i = index\\n          \\\"\\n          [ngClass]=\\\"{\\n            'flex-item-me': user.id === msg.uid,\\n            'flex-item-you': user.id !== msg.uid,\\n            'animated zoomInUp delay-1s': isSending && last\\n          }\\\"\\n        >\\n          <ion-icon\\n            class=\\\"icon-flex\\\"\\n            *ngIf=\\\"user.id !== msg.uid\\\"\\n            name=\\\"contact\\\"\\n          ></ion-icon>\\n          <div\\n            class=\\\"bubble \\\"\\n            [ngClass]=\\\"{ you: user.id !== msg.uid, me: user.id === msg.uid }\\\"\\n          >\\n            <div>{{ msg.content }}</div>\\n          </div>\\n\\n          <small *ngIf=\\\"user.id !== msg.uid\\\">{{\\n            msg.typeOfUser === 'buyer'\\n              ? 'comprador'\\n              : msg.typeOfUser === 'seller'\\n              ? 'vendedor'\\n              : msg.typeOfUser === 'preBuyer'\\n              ? 'comprador'\\n              : 'administrador'\\n          }}</small>\\n          {{ last ? lastScroll(i) : '' }}\\n        </span>\\n      </div>\\n\\n      <h5 *ngIf=\\\"chat.messages.length === 0\\\">Escriba una pregunta</h5>\\n    </div>\\n  </div>\\n</ion-content>\\n<ion-footer>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <textarea\\n      #myInput\\n      id=\\\"myInput\\\"\\n      rows=\\\"1\\\"\\n      maxlength=\\\"500\\\"\\n      (keyup)=\\\"textAreaKeyup()\\\"\\n      [(ngModel)]=\\\"contentText\\\"\\n      class=\\\"textarea-chat\\\"\\n      (keydown.enter)=\\\"submit()\\\"\\n    ></textarea>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"submit()\\\" *ngIf=\\\"isSending !== false\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"send\\\"></ion-icon>\\n      </ion-button>\\n      <ion-button *ngIf=\\\"isSending === false\\\">\\n        <ion-spinner\\n          slot=\\\"icon-only\\\"\\n          name=\\\"dots\\\"\\n          color=\\\"secondary\\\"\\n        ></ion-spinner>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","module.exports = \".ta-frame {\\n  margin: 0;\\n  padding: 10px 10px;\\n  width: 230px;\\n  height: 20px;\\n  border-top: 1px solid gray;\\n  background-color: #eee; }\\n\\n.textarea-chat {\\n  overflow: hidden;\\n  background-color: white;\\n  color: black;\\n  width: calc(100% - 10px);\\n  border: 0;\\n  border-radius: 12px; }\\n\\n.speech-bubble-you {\\n  position: relative;\\n  background: #c0c0c0;\\n  border-radius: .4em; }\\n\\n.bubble {\\n  border-radius: 5px;\\n  box-shadow: 0 0 6px #B2B2B2;\\n  padding: 9px 18px;\\n  position: relative;\\n  vertical-align: top; }\\n\\n.bubble::before {\\n  content: \\\"\\\\00a0\\\";\\n  display: block;\\n  height: 16px;\\n  position: absolute;\\n  top: 11px;\\n  transform: rotate(29deg) skew(-35deg);\\n  -moz-transform: rotate(29deg) skew(-35deg);\\n  -ms-transform: rotate(29deg) skew(-35deg);\\n  -o-transform: rotate(29deg) skew(-35deg);\\n  -webkit-transform: rotate(29deg) skew(-35deg);\\n  width: 20px; }\\n\\n.you {\\n  margin: 1px 45px 1px 20px;\\n  /* background-color: #014598;\\n    color: white; */\\n  background-color: #3c4252;\\n  color: #fff; }\\n\\n/* .you::before {\\n    box-shadow: -2px 2px 2px 0 rgba(178, 178, 178, .4);\\n    left: -9px;\\n    background-color: #3c4252;\\n} */\\n\\n.me {\\n  margin: 1px 20px 1px 20px;\\n  /* background-color: #1E88E5;\\n    color: white; */\\n  color: rgba(0, 0, 0, 0.87);\\n  background-color: #e0e0e0; }\\n\\n/* .me::before {\\n    box-shadow: 2px -2px 2px 0 rgba(178, 178, 178, .4);\\n    right: -9px;\\n    background-color: #e0e0e0;\\n\\n} */\\n\\n.flex-contenet {\\n  display: flex;\\n  flex-direction: column; }\\n\\n.flex-item-you {\\n  max-width: 250px;\\n  align-self: flex-start; }\\n\\n.flex-item-me {\\n  max-width: 250px;\\n  align-self: flex-end; }\\n\\nsmall {\\n  margin: 18%; }\\n\\n.item-bottom {\\n  margin-bottom: 8px; }\\n\\n.icon-flex {\\n  position: relative;\\n  top: 36px;\\n  font-size: 1.6em;\\n  right: 8px; }\\n\\ntextarea:focus,\\ninput:focus {\\n  outline: none; }\\n\"","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ElementRef,\n  AfterViewChecked,\n  OnDestroy\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ChatService } from '../../../services/chat.service';\nimport { Observable } from 'rxjs/internal/Observable';\nimport { IChat, IMessage } from '../../../models/chat.model';\nimport { Content } from '@ionic/angular';\nimport { UserSessionService } from '../../../services/user-session.service';\nimport { IUserSession } from '../../../models/userSession.model';\nimport { PropertyService } from '../../../services/property.service';\nimport { SocketIoService } from '../../../services/socket-io.service';\nimport { OnesignalService } from '../../../services/onesignal.service';\nimport { INotification } from '../../../models/notification.model';\nimport { map } from 'rxjs/internal/operators/map';\nimport { SellerService } from '../../../services/seller.service';\nimport { IProperty } from '../../../models/property.model';\nimport { ISeller } from '../../../models/seller.model';\nimport { BuyerService } from '../../../services/buyer.service';\nimport { IBuyer } from '../../../models/buyer.model';\nimport { PreBuildService } from '../../../services/pre-build.service';\n\n@Component({\n  selector: 'app-chat-room',\n  templateUrl: './chat-room.component.html',\n  styleUrls: ['./chat-room.component.scss']\n})\nexport class ChatRoomComponent implements OnInit, OnDestroy {\n  property: IProperty;\n  chat: IChat;\n  isLoad: boolean;\n  isSending: boolean;\n  istoLast = false;\n  user: IUserSession;\n  title: string;\n  contentText: string;\n  seller: ISeller;\n  private oldHeigh: number;\n  /**\n   * heigh altura eb el numero de str\n   */\n  private stringHeigh: { heigh: number; numOfstring: number }[] = [];\n  private isFirstEnter = false;\n  @ViewChild(Content) content: Content;\n  @ViewChild('myInput') myInput: ElementRef;\n  buyer: IBuyer;\n\n  constructor(\n    private route: ActivatedRoute,\n    private chatService: ChatService,\n    private userService: UserSessionService,\n    private propertyService: PropertyService,\n    private preBuildService: PreBuildService,\n    private socketService: SocketIoService,\n    private oneSignalService: OnesignalService,\n    private sellerService: SellerService,\n    private router: Router,\n    private buyerService: BuyerService\n  ) {\n    this.user = userService.userSession.value;\n    this.route.queryParams.subscribe(async params => {\n      if (params.id) {\n        if (this.user.type === 'preBuyer') {\n          this.getRoomById(params.id);\n          const prop = await this.getprePropertyById(params.id);\n          this.property = prop;\n          this.title = prop.name;\n        } else {\n          this.getRoomById(params.id);\n          const prop = await this.getPropertyById(params.id);\n          this.seller = await this.getSellerOfProperty(params.id);\n          this.property = prop;\n          this.title = prop.name ? prop.name : '';\n        }\n      }\n    });\n    this.socketService.onNewMsg().subscribe(chatId => {\n      if (chatId === this.chat._id) {\n        this.getRoomByChatId(this.chat._id);\n      }\n    });\n  }\n\n  ngOnInit() {}\n  textAreaKeyup() {\n    // da el primer valor\n    if (!this.isFirstEnter) {\n      this.oldHeigh = this.myInput.nativeElement.scrollHeight;\n      this.isFirstEnter = true;\n    }\n    // solo cuando incrementa\n    if (this.myInput.nativeElement.scrollHeight > this.oldHeigh) {\n      // registra num de str si no esta en el arreglo\n      this.stringHeigh.push({\n        heigh: this.oldHeigh,\n        numOfstring: this.contentText.length - 1\n      });\n      // de nuevo valor para detectar cambio\n      this.oldHeigh = this.myInput.nativeElement.scrollHeight;\n    }\n    const s = this.stringHeigh.findIndex(\n      sh => sh.numOfstring === this.contentText.length\n    );\n    // si regresa da valor de altura antiguo\n    if (s !== -1) {\n      this.myInput.nativeElement.style.height =\n        this.stringHeigh[s].heigh + 'px';\n      this.stringHeigh.splice(s, 1);\n      this.oldHeigh = this.myInput.nativeElement.scrollHeight;\n    } else {\n      // valor nuevo de altura al incrementar\n      this.myInput.nativeElement.style.height =\n        this.myInput.nativeElement.scrollHeight + 'px';\n    }\n  }\n\n  getRoomById(id) {\n    this.isLoad = false;\n    this.chatService.getByProp(id).subscribe(async chat => {\n      if (chat === null) {\n        this.newChat(id);\n      } else {\n        this.chat = chat;\n        this.buyer = await this.getBuyerOfId(chat.buyer);\n\n        this.scrollBottom();\n        this.isLoad = true;\n      }\n    });\n  }\n  getRoomByChatId(id) {\n    this.chatService.getByChatId(id).subscribe(chat => {\n      this.chat = chat;\n      this.scrollBottom();\n      this.isLoad = true;\n      this.isSending = true;\n      console.log(chat);\n    });\n  }\n  async getPropertyById(id) {\n    let prop = await this.propertyService.getPropertyById(id).toPromise();\n    if (prop !== null) {\n      return prop;\n    } else {\n      prop = await this.preBuildService.getBuildById(id).toPromise();\n      return prop;\n    }\n  }\n  async getprePropertyById(propId) {\n    return await this.preBuildService.getBuildById(propId).toPromise();\n  }\n  async submit() {\n    this.isSending = false;\n    const newMessage: IMessage = {\n      content: this.contentText,\n      createAt: new Date(),\n      readBy: [this.user.id],\n      uid: this.user.id,\n      typeOfUser: this.user.type\n    };\n    const res = await this.chatService\n      .addMsg(this.chat._id, newMessage)\n      .toPromise();\n    if (res) {\n      // vendedor id notifica\n      const seller = await this.getSellerOfProperty(this.property._id);\n      let arrToSendId = [];\n      if (seller === undefined) {\n        arrToSendId = [this.chat.buyer];\n      } else {\n        arrToSendId = [seller._id, this.chat.buyer];\n      }\n      const findIndex = arrToSendId.findIndex(id => id === this.user.id);\n      if (findIndex !== -1) {\n        arrToSendId.splice(findIndex, 0);\n      }\n      this.notification(\n        'Nuevo Mensaje',\n        `${this.user.name}: ${this.contentText}`,\n        'verde',\n        'msg',\n        ['office', 'management'],\n        arrToSendId\n      );\n    }\n    if (this.stringHeigh.length > 0) {\n      this.myInput.nativeElement.style.height =\n        this.stringHeigh[0].heigh + 'px';\n      this.stringHeigh.length = 0;\n    }\n    this.contentText = ''.trim();\n    this.scrollBottom();\n  }\n  newChat(propId) {\n    this.chatService.newChat(this.user.id, propId).subscribe(chat => {\n      this.chat = chat;\n      this.isLoad = true;\n    });\n  }\n  trackByCreated(msg: IMessage) {\n    return msg.createAt;\n  }\n  scrollBottom() {\n    // this.content.scrollToBottom();\n    setTimeout(() => {\n      this.content.scrollToBottom();\n    }, 10);\n  }\n  lastScroll(i) {\n    // console.log(i);\n    if (!this.istoLast && i === this.chat.messages.length - 1) {\n      setTimeout(() => {\n        this.content.scrollToBottom();\n      }, 10);\n      this.istoLast = true;\n    }\n  }\n  // _helpers\n  public notification(\n    title,\n    message,\n    status,\n    type,\n    tags,\n    reciversId: string[]\n  ) {\n    // notificacion\n    const notification: INotification = {\n      title: title,\n      message: message,\n      tags: tags,\n      receiversId: reciversId,\n      senderId: this.userService.userSession.value.id,\n      status: status,\n      type: type\n    };\n    // onesignal\n    this.oneSignalService\n      .postOneSignalByTag(notification.title, message, tags, reciversId)\n      .subscribe(() => {\n        // guardar noti\n        this.oneSignalService.newNotification(notification).subscribe();\n      });\n  }\n  async getSellerOfProperty(id) {\n    return await this.sellerService\n      .getSellerAll()\n      .pipe(\n        map(sellers => sellers.find(s => !!s.property.find(p => p._id === id)))\n      )\n      .toPromise();\n  }\n  async getBuyerOfId(buyerId) {\n    return await this.buyerService.getBuyerById(buyerId).toPromise();\n  }\n  private readMsg() {\n    const ids = this.chat.messages\n      .filter(m => !m.readBy.some(r => r === this.user.id))\n      .map(msg => msg._id);\n\n    this.chatService.addRead(this.chat._id, ids, this.user.id).subscribe();\n  }\n  ngOnDestroy() {\n    this.readMsg();\n  }\n  backOne() {\n    this.router\n      .navigateByUrl('/RefrshComponent', { skipLocationChange: true })\n      .then(() => this.router.navigate(['chat']));\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPage } from './chat.page';\nimport { ChatRoomComponent } from './chat-room/chat-room.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage,\n  },\n  {\n    path: 'room',\n    component: ChatRoomComponent,\n  },\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n  ],\n  declarations: [ChatPage, ChatRoomComponent],\n})\nexport class ChatPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button style=\\\"color: white\\\"></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title> Chat </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content padding>\\n  <ng-container\\n    *ngIf=\\\"\\n      user.type === 'buyer' || user.type === 'preBuyer';\\n      then: Buyer;\\n      else: NoBuyer\\n    \\\"\\n  ></ng-container>\\n  <ng-template #Buyer>\\n    <!-- En listar status azul -->\\n    <ng-container *ngIf=\\\"propertiesBuyer.length > 0; else: notBlue\\\">\\n      <ion-card\\n        *ngFor=\\\"let item of propertiesBuyer\\\"\\n        [ngClass]=\\\"{\\n          'state-verde': item.status === 'verde',\\n          'state-amarillo': item.status === 'amarillo',\\n          'state-rojo': item.status === 'rojo',\\n          'state-azul': item.status === 'azul'\\n        }\\\"\\n        (click)=\\\"goToRoom(item.property._id)\\\"\\n      >\\n        <ion-card-header>\\n          <ion-item lines=\\\"none\\\">\\n            <ion-card-title text-wrap>{{ item.property.name }}</ion-card-title>\\n            <ion-icon *ngIf=\\\"item.noRead > 0\\\" slot=\\\"end\\\" name=\\\"mail\\\"></ion-icon>\\n            <ion-badge *ngIf=\\\"item.noRead > 0\\\" id=\\\"badge\\\" color=\\\"danger\\\">{{\\n              item.noRead\\n            }}</ion-badge>\\n          </ion-item>\\n        </ion-card-header>\\n        <ion-card-content class=\\\"content-card-chat\\\">\\n          <ion-item lines=\\\"none\\\">\\n            <ion-icon\\n              style=\\\"color:  #F5811E\\\"\\n              name=\\\"arrow-forward\\\"\\n              slot=\\\"end\\\"\\n            ></ion-icon>\\n            <ion-label text-wrap>Chat de la propiedad</ion-label>\\n          </ion-item>\\n        </ion-card-content>\\n      </ion-card>\\n    </ng-container>\\n    <ng-template #notBlue>\\n      <h5 *ngIf=\\\"propertiesBuyer.length === 0 && isLoad\\\">\\n        No cuentas con propiedades adquiridas para generar chat\\n      </h5>\\n      <ion-spinner\\n        *ngIf=\\\"propertiesBuyer.length === 0 && !isLoad\\\"\\n        name=\\\"bubbles\\\"\\n      ></ion-spinner>\\n    </ng-template>\\n  </ng-template>\\n  <ng-template #NoBuyer>\\n    <!-- todos los chat para admin ofice -->\\n    <!-- filtrar los chat para seller y manag -->\\n    <div *ngIf=\\\"isLoad\\\" class=\\\"my-contenet\\\">\\n      <ion-card\\n        *ngFor=\\\"let chat of chats\\\"\\n        class=\\\"state-azul\\\"\\n        (click)=\\\"goToRoom(chat.property)\\\"\\n      >\\n        <ion-card-header>\\n          <ion-item lines=\\\"none\\\">\\n            <ion-card-title *ngIf=\\\"chat.prop\\\" text-wrap>{{\\n              chat.prop.name\\n            }}</ion-card-title>\\n            <ion-icon *ngIf=\\\"chat.noRead > 0\\\" slot=\\\"end\\\" name=\\\"mail\\\"></ion-icon>\\n            <ion-badge *ngIf=\\\"chat.noRead > 0\\\" id=\\\"badge\\\" color=\\\"danger\\\">{{\\n              chat.noRead\\n            }}</ion-badge>\\n          </ion-item>\\n        </ion-card-header>\\n        <ion-card-content class=\\\"content-card-chat\\\">\\n          <ion-item lines=\\\"none\\\">\\n            <ion-icon\\n              style=\\\"color:  #F5811E\\\"\\n              name=\\\"arrow-forward\\\"\\n              slot=\\\"end\\\"\\n            ></ion-icon>\\n            <ion-label text-wrap>Chat de la propiedad</ion-label>\\n          </ion-item>\\n        </ion-card-content>\\n      </ion-card>\\n    </div>\\n  </ng-template>\\n</ion-content>\\n\"","module.exports = \".content-card-chat {\\n  padding: 0px 20px 10px 20px !important; }\\n\\n#badge {\\n  position: absolute;\\n  top: 1px;\\n  right: 2px;\\n  font-size: x-small; }\\n\"","import { Component, OnInit } from '@angular/core';\nimport { UserSessionService } from '../../services/user-session.service';\nimport { IUserSession } from '../../models/userSession.model';\nimport { StatusBuyerPropertyService } from '../../services/status-buyer-property.service';\nimport { map } from 'rxjs/operators';\nimport { Observable } from 'rxjs/internal/Observable';\nimport {\n  IStatusBuyerProperty,\n  IStatusBuyerPropertyGet\n} from '../../models/statusBuyerProperty.model';\nimport { ChatService } from '../../services/chat.service';\nimport { Router, NavigationExtras } from '@angular/router';\nimport { IChat } from '../../models/chat.model';\nimport { SellerService } from '../../services/seller.service';\nimport { PropertyService } from '../../services/property.service';\nimport { PreBuyerService } from '../../services/pre-buyer.service';\nimport { PreBuildService } from '../../services/pre-build.service';\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.page.html',\n  styleUrls: ['./chat.page.scss']\n})\nexport class ChatPage implements OnInit {\n  user: IUserSession;\n  propertiesBuyer = [];\n  chats: any[] = [];\n  isLoad: boolean;\n  constructor(\n    private userSessionService: UserSessionService,\n    private statusBPService: StatusBuyerPropertyService,\n    private chatService: ChatService,\n    private router: Router,\n    private sellerService: SellerService,\n    private propertyService: PropertyService,\n    private preBuyerService: PreBuyerService,\n    private preBuildService: PreBuildService\n  ) {\n    this.user = userSessionService.userSession.value;\n  }\n\n  ngOnInit() {\n    if (this.user.type === 'buyer') {\n      this.getStatus();\n    } else if (this.user.type === 'preBuyer') {\n      this.getPrebuyer();\n    } else {\n      this.getRoomChatsByUser();\n    }\n  }\n  getPrebuyer() {\n    this.preBuyerService.getBuyerById(this.user.id).subscribe(buyer => {\n      const buildsToChat = buyer.preBuild.filter(\n        build => !build.timeLine.some(b => !b.isComplete)\n      );\n      console.log(buildsToChat);\n      if (buildsToChat.length > 0) {\n        buildsToChat.forEach(async build => {\n          this.propertiesBuyer.push({\n            status: 'azul',\n            property: { _id: build._id, name: build.name },\n            noRead: await this.getMsgNotReadByProp(build._id)\n          });\n        });\n        console.log(this.propertiesBuyer);\n      }\n    });\n  }\n  getStatus() {\n    // por status azul\n    this.isLoad = false;\n    this.statusBPService\n      .findByBuyer(this.user.id)\n      .pipe(map(sbp => sbp.filter(s => s.status === 'azul')))\n      .subscribe(pb => {\n        this.propertiesBuyer = pb;\n        this.propertiesBuyer.map(async sBP => {\n          sBP['noRead'] = await this.getMsgNotReadByProp(sBP.property._id);\n        });\n        this.isLoad = true;\n      });\n  }\n  getRoomChatsByUser() {\n    this.isLoad = false;\n    this.chatService.getAll().subscribe(async chatsAll => {\n      chatsAll.forEach(chat => {\n        this.checkIsLive(chat.property, chat._id);\n      });\n      // filtro por seller\n      if (this.user.type === 'seller') {\n        const seller = await this.getSeller();\n        this.chats = chatsAll.filter(chat => {\n          return seller.property.some(p => p._id === chat.property);\n        });\n      } else if (this.user.type === 'management') {\n        this.chats = chatsAll.filter(chat => {\n          return chat.city === 'Puebla';\n        });\n      } else {\n        this.chats = chatsAll;\n      }\n      this.chats.map(async c => {\n        c['noRead'] = await this.getMsgNotReadByProp(c.property);\n        c['prop'] = await this.getProperty(c.property);\n      });\n      this.isLoad = true;\n    });\n  }\n  async getMsgNotReadByProp(propId: string) {\n    const chat = await this.chatService.getByProp(propId).toPromise();\n    if (chat !== null) {\n      return chat.messages.filter(m => !m.readBy.some(r => r === this.user.id))\n        .length;\n    } else {\n      return 0;\n    }\n  }\n  goToRoom(id) {\n    const data: NavigationExtras = { queryParams: { id: id } };\n    this.router.navigate(['chat/room'], data);\n  }\n  async getSeller() {\n    return await this.sellerService.getSellerById(this.user.id).toPromise();\n  }\n  async getProperty(id) {\n    let prop = await this.propertyService.getPropertyById(id).toPromise();\n    if (prop !== null) {\n      return prop;\n    } else {\n      prop = await this.preBuildService.getBuildById(id).toPromise();\n      return prop;\n    }\n  }\n  async checkIsLive(propId, chatId) {\n    let prop = await this.propertyService.getPropertyById(propId).toPromise();\n    if (prop === null) {\n      prop = await this.preBuildService.getBuildById(propId).toPromise();\n      if (prop === null) {\n        this.chatService.deletedById(chatId).subscribe();\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable } from 'rxjs/internal/Observable';\nimport { map } from 'rxjs/internal/operators/map';\nimport { END_POINT } from '../_config/api.end-points';\nimport { IChat, IMessage } from '../models/chat.model';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ChatService {\n  constructor(private http: HttpClient) {}\n  public getAll(): Observable<IChat[]> {\n    return this.http.get(END_POINT.CHAT).pipe(map((data: any) => data.data));\n  }\n  public getByProp(propertyId: string): Observable<IChat> {\n    return this.http\n      .get(END_POINT.CHAT_PROP_ID + propertyId)\n      .pipe(map((data: any) => data.data));\n  }\n  public getByChatId(chatId: string): Observable<IChat> {\n    return this.http\n      .get(END_POINT.CHAT_ID + chatId)\n      .pipe(map((data: any) => data.data));\n  }\n  public getByCity(cityId: string): Observable<IChat[]> {\n    return this.http\n      .get(END_POINT.CHAT_CITY_ID + cityId)\n      .pipe(map((data: any) => data.data));\n  }\n  public addMsg(chatId: string, newMessages: IMessage): Observable<IChat> {\n    const body = { _id: chatId, newMessages };\n    return this.http\n      .post(END_POINT.CHAT_ADD_MSG, body)\n      .pipe(map((data: any) => data.data));\n  }\n  public addRead(chatId: string, messagesId: string[], uid): Observable<IChat> {\n    const body = { _id: chatId, messagesId, uid };\n    return this.http\n      .post(END_POINT.CHAT_ADD_READ, body)\n      .pipe(map((data: any) => data.data));\n  }\n  public newChat(\n    buyerId: string,\n    propertyId: string,\n    city = 'Puebla'\n  ): Observable<IChat> {\n    const body = {\n      buyer: buyerId,\n      property: propertyId,\n      city: city,\n      messages: []\n    };\n    return this.http\n      .post(END_POINT.CHAT, body)\n      .pipe(map((data: any) => data.data));\n  }\n  public deletedById(id: string): Observable<boolean> {\n    return this.http\n      .delete(END_POINT.CHAT + id)\n      .pipe(map((data: any) => data.data));\n  }\n  /*   public get(buyerId: string, percentage = 10): Observable<boolean> {\n    const body = { percentage: percentage };\n    return this.http\n      .post(END_POINT.PROPERTY_MATCH_SEARCH + buyerId, body)\n      .pipe(map((data: any) => data.data));\n  }\n  public getPropertyById(id: string): Observable<IProperty> {\n    return this.http\n      .get(END_POINT.PROPERTY_BY_ID + id)\n      .pipe(map((data: any) => data.data));\n  }\n  public getAll(): Observable<IProperty[]> {\n    return this.http\n      .get(END_POINT.PROPERTY)\n      .pipe(map((data: any) => data.data));\n  }\n  public getAllSpecial(): Observable<IProperty[]> {\n    return this.http\n      .get(END_POINT.PROPERTY_ALL)\n      .pipe(map((data: any) => data.data));\n  }\n  public deletedById(id: string): Observable<boolean> {\n    return this.http\n      .delete(END_POINT.PROPERTY + id)\n      .pipe(map((data: any) => data.data));\n  }\n  public newProperty(property: IProperty): Observable<IProperty> {\n    return this.http\n      .post(END_POINT.PROPERTY, property)\n      .pipe(map((data: any) => data.data));\n  }\n  public putProperty(property: IProperty): Observable<boolean> {\n    return this.http\n      .put(END_POINT.PROPERTY + property._id, property)\n      .pipe(map((data: any) => data.data));\n  }\n  public getPropertySimulate(\n    property: IProperty,\n    percentage: number,\n  ): Observable<IProperty[]> {\n    const body: any = property;\n    body.percentage = percentage;\n    return this.http\n      .post(END_POINT.PROPERTY_SIMULATE, body)\n      .pipe(map((data: any) => data.data));\n  } */\n}\n"],"sourceRoot":""}